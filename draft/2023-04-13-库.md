---
layout: post
title: 库文件
subtitle: C++学习笔记
date: 2023-04-13 19:50:00 +0800
categories: C++
author: 月梦
tags: 
- C++  
---

## 库
- 库文件是计算机上的一类文件，可以简单的把库文件看成一种代码仓库，它提供给使用者一些可以直接拿来用的变量、函数或类。  
- 库文件有两种，静态库和动态库（共享库），区别是：静态库在程序的链接阶段被复制到程序中；动态库在链接阶段没有被复制到程序中，而是程序在运行时由系统动态加载到内存中供程序调用。  
- 库的好处：代码保密&方便部署和分发

## 静态库
### 静态库命名
Linux下以"libxxx.a"命名，其中"lib"是前缀，是固定的，"xxx"是库的名字，自己起，".a"是后缀，是固定的  
Windows下以"libxxx.lib"命名  
### 静态库制作
gcc获得.o文件，将.o文件打包，使用ar工具(archive)
```
#r - 将文件插入备存文件中
#c - 建立备存文件
#s - 索引
ar rcs libxxx.a xxx.o xxx.o ...
```

### 静态库如何使用？
```
gcc main.c -o app -I ./include/ -l calc -L./lib
#-I表示去哪个文件夹找头文件，-l表示使用指定库的名称（**注意：不是库文件的名称，只需要写库的名称即可**），-L表示要去哪个目录下寻找库文件  
```


## 动态库
### 动态库命名
Linux下名称为"libxxx.so"，其中"lib"是前缀（固定），"xxx"是库的名字，自己起，".so"是后缀，也是固定的，在linux下是一个可执行文件  
Windows下名称为"libxxx.dll"  
### 动态库的制作
- gcc得到.o文件，得到和位置无关的代码  
```
gcc -c -fpic/-fPIC a.c b.c
```
- gcc得到动态库  
```
gcc -shared a.o b.o -o libcalc.so
```